import{t as z,a as W}from"./BWCsPxKq.js";import{i as X}from"./Com66ilP.js";import{z as Y,A as q,B as Z,C,D as k,F as x,t as O,G as I,I as j,J as N}from"./C8M7huGC.js";import{e as ee,s as D}from"./CeWid8xA.js";import{_ as te,i as re}from"./D8ZUucn5.js";/*! Capacitor: https://capacitorjs.com/ - MIT License */var E;(function(r){r.Unimplemented="UNIMPLEMENTED",r.Unavailable="UNAVAILABLE"})(E||(E={}));class G extends Error{constructor(e,t,n){super(e),this.message=e,this.code=t,this.data=n}}const se=r=>{var e,t;return r!=null&&r.androidBridge?"android":!((t=(e=r==null?void 0:r.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},ne=r=>{const e=r.CapacitorCustomPlatform||null,t=r.Capacitor||{},n=t.Plugins=t.Plugins||{},i=()=>e!==null?e.name:se(r),s=()=>i()!=="web",c=o=>{const a=h.get(o);return!!(a!=null&&a.platforms.has(i())||l(o))},l=o=>{var a;return(a=t.PluginHeaders)===null||a===void 0?void 0:a.find(v=>v.name===o)},d=o=>r.console.error(o),h=new Map,m=(o,a={})=>{const v=h.get(o);if(v)return console.warn(`Capacitor plugin "${o}" already registered. Cannot register plugins twice.`),v.proxy;const g=i(),y=l(o);let w;const F=async()=>(!w&&g in a?w=typeof a[g]=="function"?w=await a[g]():w=a[g]:e!==null&&!w&&"web"in a&&(w=typeof a.web=="function"?w=await a.web():w=a.web),w),V=(u,f)=>{var b,P;if(y){const L=y==null?void 0:y.methods.find(p=>f===p.name);if(L)return L.rtype==="promise"?p=>t.nativePromise(o,f.toString(),p):(p,_)=>t.nativeCallback(o,f.toString(),p,_);if(u)return(b=u[f])===null||b===void 0?void 0:b.bind(u)}else{if(u)return(P=u[f])===null||P===void 0?void 0:P.bind(u);throw new G(`"${o}" plugin is not implemented on ${g}`,E.Unimplemented)}},A=u=>{let f;const b=(...P)=>{const L=F().then(p=>{const _=V(p,u);if(_){const $=_(...P);return f=$==null?void 0:$.remove,$}else throw new G(`"${o}.${u}()" is not implemented on ${g}`,E.Unimplemented)});return u==="addListener"&&(L.remove=async()=>f()),L};return b.toString=()=>`${u.toString()}() { [capacitor code] }`,Object.defineProperty(b,"name",{value:u,writable:!1,configurable:!1}),b},H=A("addListener"),R=A("removeListener"),Q=(u,f)=>{const b=H({eventName:u},f),P=async()=>{const p=await b;R({eventName:u,callbackId:p},f)},L=new Promise(p=>b.then(()=>p({remove:P})));return L.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await P()},L},U=new Proxy({},{get(u,f){switch(f){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return y?Q:H;case"removeListener":return R;default:return A(f)}}});return n[o]=U,h.set(o,{name:o,proxy:U,platforms:new Set([...Object.keys(a),...y?[g]:[]])}),U};return t.convertFileSrc||(t.convertFileSrc=o=>o),t.getPlatform=i,t.handleError=d,t.isNativePlatform=s,t.isPluginAvailable=c,t.registerPlugin=m,t.Exception=G,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t},ie=r=>r.Capacitor=ne(r),S=ie(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),T=S.registerPlugin;class J{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let n=!1;this.listeners[e]||(this.listeners[e]=[],n=!0),this.listeners[e].push(t);const s=this.windowListeners[e];s&&!s.registered&&this.addWindowListener(s),n&&this.sendRetainedArgumentsForEvent(e);const c=async()=>this.removeListener(e,t);return Promise.resolve({remove:c})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,n){const i=this.listeners[e];if(!i){if(n){let s=this.retainedEventArguments[e];s||(s=[]),s.push(t),this.retainedEventArguments[e]=s}return}i.forEach(s=>s(t))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:n=>{this.notifyListeners(t,n)}}}unimplemented(e="not implemented"){return new S.Exception(e,E.Unimplemented)}unavailable(e="not available"){return new S.Exception(e,E.Unavailable)}async removeListener(e,t){const n=this.listeners[e];if(!n)return;const i=n.indexOf(t);this.listeners[e].splice(i,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(n=>{this.notifyListeners(e,n)}))}}const B=r=>encodeURIComponent(r).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),K=r=>r.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class oe extends J{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(n=>{if(n.length<=0)return;let[i,s]=n.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");i=K(i).trim(),s=K(s).trim(),t[i]=s}),t}async setCookie(e){try{const t=B(e.key),n=B(e.value),i=`; expires=${(e.expires||"").replace("expires=","")}`,s=(e.path||"/").replace("path=",""),c=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${n||""}${i}; path=${s}; ${c};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}T("CapacitorCookies",{web:()=>new oe});const ae=async r=>new Promise((e,t)=>{const n=new FileReader;n.onload=()=>{const i=n.result;e(i.indexOf(",")>=0?i.split(",")[1]:i)},n.onerror=i=>t(i),n.readAsDataURL(r)}),ce=(r={})=>{const e=Object.keys(r);return Object.keys(r).map(i=>i.toLocaleLowerCase()).reduce((i,s,c)=>(i[s]=r[e[c]],i),{})},le=(r,e=!0)=>r?Object.entries(r).reduce((n,i)=>{const[s,c]=i;let l,d;return Array.isArray(c)?(d="",c.forEach(h=>{l=e?encodeURIComponent(h):h,d+=`${s}=${l}&`}),d.slice(0,-1)):(l=e?encodeURIComponent(c):c,d=`${s}=${l}`),`${n}&${d}`},"").substr(1):null,de=(r,e={})=>{const t=Object.assign({method:r.method||"GET",headers:r.headers},e),i=ce(r.headers)["content-type"]||"";if(typeof r.data=="string")t.body=r.data;else if(i.includes("application/x-www-form-urlencoded")){const s=new URLSearchParams;for(const[c,l]of Object.entries(r.data||{}))s.set(c,l);t.body=s.toString()}else if(i.includes("multipart/form-data")||r.data instanceof FormData){const s=new FormData;if(r.data instanceof FormData)r.data.forEach((l,d)=>{s.append(d,l)});else for(const l of Object.keys(r.data))s.append(l,r.data[l]);t.body=s;const c=new Headers(t.headers);c.delete("content-type"),t.headers=c}else(i.includes("application/json")||typeof r.data=="object")&&(t.body=JSON.stringify(r.data));return t};class ue extends J{async request(e){const t=de(e,e.webFetchExtra),n=le(e.params,e.shouldEncodeUrlParams),i=n?`${e.url}?${n}`:e.url,s=await fetch(i,t),c=s.headers.get("content-type")||"";let{responseType:l="text"}=s.ok?e:{};c.includes("application/json")&&(l="json");let d,h;switch(l){case"arraybuffer":case"blob":h=await s.blob(),d=await ae(h);break;case"json":d=await s.json();break;case"document":case"text":default:d=await s.text()}const m={};return s.headers.forEach((o,a)=>{m[a]=o}),{data:d,headers:m,status:s.status,url:s.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}T("CapacitorHttp",{web:()=>new ue});const M=T("GoogleFit",{web:()=>te(()=>import("./DdISuOxU.js"),[],import.meta.url).then(r=>new r.GoogleFitWeb)});var fe=z('<div class="card svelte-14cti6s"><h3>Google Fit Data (Last 24h)</h3> <p><strong>Calories:</strong> </p> <p><strong>Distance:</strong> </p></div>'),ge=z('<div class="center-screen svelte-14cti6s"><button class="svelte-14cti6s"> </button> <!></div>');function ve(r,e){Y(e,!1);let t=I(null),n=I(!1);async function i(){var m;try{j(n,!0),await M.connectToGoogleFit();const o=new Date,a=new Date;a.setDate(o.getDate()-1);const v=await M.getHistory({startTime:a,endTime:o}),g=((m=v.days)==null?void 0:m[0])??{};j(t,{calories:parseFloat(g.calories??0),distanceKm:parseFloat(g.distance??"0")/1e3}),console.info("Fetched Historical Google Fit data:",JSON.stringify(v,null,2))}catch(o){console.error("Failed to fetch Google Fit data:",o),alert("Could not connect to Google Fit.")}finally{j(n,!1)}}X();var s=ge(),c=C(s),l=C(c,!0);k(c);var d=x(c,2);{var h=m=>{var o=fe(),a=x(C(o),2),v=x(C(a));k(a);var g=x(a,2),y=x(C(g));k(g),k(o),q((w,F)=>{D(v,` ${w??""} kcal`),D(y,` ${F??""} km`)},[()=>O(t).calories.toFixed(0),()=>O(t).distanceKm.toFixed(2)],N),W(m,o)};re(d,m=>{O(t)&&m(h)})}k(s),q(()=>{c.disabled=O(n),D(l,O(n)?"Loading...":"Show Google Fit Data")}),ee("click",c,i),W(r,s),Z()}export{J as W,ve as _};
